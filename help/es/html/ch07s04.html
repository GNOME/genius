<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Variables locales verdaderas</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Manual de Genius"><link rel="up" href="ch07.html" title="Capítulo 7. Programación avanzada con GEL"><link rel="prev" href="ch07s03.html" title="Devolver funciones"><link rel="next" href="ch07s05.html" title="Procedimiento de inicio de GEL"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Variables locales verdaderas</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch07s03.html">Anterior</a> </td><th width="60%" align="center">Capítulo 7. Programación avanzada con GEL</th><td width="20%" align="right"> <a accesskey="n" href="ch07s05.html">Siguiente</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="genius-gel-true-local-variables"></a>Variables locales verdaderas</h2></div></div></div><p>Cuando se pasa una función a otras funciones, la manera predeterminada en que se determinan los ámbitos de las variables puede no ser la que quiere. Por ejemplo: </p><pre class="programlisting">k := 10;
function r(x) = (x+k);
function f(g,x) = (
  k := 5;
  g(x)
);
f(r,1)
</pre><p> probablemente quiere que la función <code class="function">r</code>, en el momento que pasa como <code class="function">g</code> a la función <code class="function">f</code>, vea la variable <code class="varname">k</code> como 10 y no 5 y que el código devuelva 11 y no 6. Sin embargo, como está escrita, la función verá <code class="varname">k</code> con el valor 5. Existen dos maneras de resolver este problema. Una es hacer que <code class="function">r</code> guarde <code class="varname">k</code> en un diccionario privado utilizando la notación de corchetes. Consulte la sección <a class="link" href="ch07s03.html" title="Devolver funciones">Devolver funciones</a>.</p><p>Pero hay otra solución. Desde la versión 1.0.7 existen variables locales verdaderas. Éstas son variables que son visibles sólo desde el contexto actual y no desde ninguna función que se llame. Se podría definir <code class="varname">k</code> como una variable local en la función <code class="function">f</code>. Para hacer esto, añada la sentencia <span class="command"><strong>local</strong></span> como la primera sentencia en la función (siempre debe de ser la primera sentencia de la función). También puede convertir cualquier argumento en una variable local. Esto es, </p><pre class="programlisting">function f(g,x) = (
  local g,x,k;
  k := 5;
  g(x)
);
</pre><p> El código funcionará como se espera e imprimirá 11. Observe que la sentencia <span class="command"><strong>local</strong></span> inicializa todas las variables que se referencian (salvo los argumentos de funciones) como una constante <code class="constant">null</code>.</p><p>Si todas las variables se crean localmente, puede pasar un asterisco en lugar de una lista de variables. En este caso las variables no se inicializarán hasta que se fijen, desde luego. Entonces, la siguiente definición de <code class="function">f</code> también funcionará: </p><pre class="programlisting">function f(g,x) = (
  local *;
  k := 5;
  g(x)
);
</pre><p>Es bueno que todas las funciones que toman otras funciones como argumentos utilicen variables locales. De esta manera las funciones que pasan no ven los detalles de la implementación y luego no se confunden.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch07s03.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch07.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch07s05.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Devolver funciones </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Procedimiento de inicio de GEL</td></tr></table></div></body></html>
